<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>For You üåª</title>
  <link rel="stylesheet" href="sunflower.css">
</head>

<body class="sunflower state-opening">

  <div class="sunflower-scene">

  <!-- HER PHOTO 
  <div class="hero-photo">
    <img src="her.jpg" alt="her">
  </div>-->

  <!-- SUNFLOWER -->
<div class="sunflower-wrapper" id="sunflowerWrap">
  <img src="sunflower.svg" class="sunflower-main" alt="Sunflower">
</div>
<div class="petal-field">
  <!-- 12‚Äì16 petals is enough -->
  <img src="sunflower-petal.svg" class="burst-petal">
  <img src="sunflower-petal.svg" class="burst-petal">
  <img src="sunflower-petal.svg" class="burst-petal">
  <img src="sunflower-petal.svg" class="burst-petal">
  <img src="sunflower-petal.svg" class="burst-petal">
  <img src="sunflower-petal.svg" class="burst-petal">
  <img src="sunflower-petal.svg" class="burst-petal">
  <img src="sunflower-petal.svg" class="burst-petal">
  <img src="sunflower-petal.svg" class="burst-petal">
  <img src="sunflower-petal.svg" class="burst-petal">
  <img src="sunflower-petal.svg" class="burst-petal">
  <img src="sunflower-petal.svg" class="burst-petal">
</div>
 
</div>

<div class="proposal" id="proposalBox">
    <div class="buttons">
  <button id="yesBtn">Yes üíõ</button>
  <button id="noBtn">No üòê</button>
</div>
    <p class="line">Somehow, through everything,</p>
    <h1>I‚Äôve always found myself choosing you.</h1>
    <p class="question">Will you be my Valentine?</p>
  </div>
<div id="cosmosLove" class="cosmos-love">
  <div id="ui"></div>
</div>

 <script>
  const sunflower = document.querySelector(".sunflower-main");
  const petals = document.querySelectorAll(".burst-petal");

  // PHASE 1 ‚Äî sunflower compress already done via class

  // PHASE 2 ‚Äî vanish sunflower AFTER compression
  /*setTimeout(() => {
    sunflower.classList.add("sunflower-vanish");
  }, 1700); // slightly after compress end

  // PHASE 3 ‚Äî explode petals AFTER sunflower vanishes
 setTimeout(() => {
    petals.forEach(petal => {
      const x = (Math.random() - 0.5) * 600;
      const y = (Math.random() - 0.5) * 600;
      const r = Math.random() * 360;

      const ox = (Math.random() - 0.5) * 220;
      const oy = (Math.random() - 0.5) * 220;

      petal.style.setProperty("--x", `${x}px`);
      petal.style.setProperty("--y", `${y}px`);
      petal.style.setProperty("--r", `${r}deg`);
      petal.style.setProperty("--ox", `${ox}px`);
      petal.style.setProperty("--oy", `${oy}px`);

      petal.style.animation =
        "explode 1.1s cubic-bezier(0.2, 0.8, 0.3, 1) forwards";
    });
  }, 2100);*/

  // PHASE 4 ‚Äî orbit AFTER explosion finishes
</script>

<script>
  const noBtn = document.getElementById("noBtn");
  const yesBtn = document.getElementById("yesBtn");
  const proposal = document.getElementById("proposalBox");
  let noCount = 0;

  function evadeNoButton(){
    noCount++;

    const maxX = 220;
    const maxY = 40;

    const x = Math.random() * maxX;
    const y = Math.random() * maxY;

    noBtn.style.transform = `translate(${x}px, ${y}px)`;

    // After enough tries‚Ä¶ surrender üòå
    if (noCount >= 15) {
      noBtn.textContent = "Yes üíõ";
      noBtn.style.background = "#ffd84d";
      noBtn.style.color = "#5a3b00";
    }
  };

  noBtn.addEventListener("mouseenter", evadeNoButton);
  noBtn.addEventListener("click", evadeNoButton);

  noBtn.addEventListener("click", () => {
    if (noCount >= 15) {
      yesAccepted();
    }
  });

  yesBtn.addEventListener("click", yesAccepted);
function yesAccepted() {
  yesBtn.disabled = true;
  noBtn.disabled = true;

  // 1. Fade proposal
  proposal.classList.add("fade-away");

  // 2. Compress sunflower
  sunflower.classList.add("compressing");

  // 3. After compression ‚Üí explosion
  setTimeout(startExplosion, 1600);
}
function startExplosion() {
  // 1. Fade sunflower out
  sunflower.classList.add("sunflower-vanish");

  // 2. Explode petals
  petals.forEach(petal => {
    const x = (Math.random() - 0.5) * 650;
    const y = (Math.random() - 0.5) * 650;
    const r = Math.random() * 360;

    petal.style.setProperty("--x", `${x}px`);
    petal.style.setProperty("--y", `${y}px`);
    petal.style.setProperty("--r", `${r}deg`);

    petal.style.animation =
      "explode 1.2s cubic-bezier(0.2, 0.8, 0.3, 1) forwards";
  });
   setTimeout(() => {
  petals.forEach(petal => {
    petal.style.animation = "none";   // üî• THIS IS THE FIX
    petal.offsetHeight;               // force reflow (important)
    petal.classList.add("fade-away");
  });
}, 1200)


  // 3. After explosion finishes ‚Üí fade petals + cosmos
  setTimeout(revealCosmos, 2000);
}
function revealCosmos() {
  // Fade exploded petals
  document.querySelectorAll(".burst-petal").forEach(petal => {
    petal.classList.add("fade-away");
  });

  // Switch background to cosmos
  document.body.classList.remove("state-opening");
  document.body.classList.add("state-cosmos");

  // STEP 5 ‚Äî show floating love
  const cosmosLove = document.getElementById("cosmosLove");
  if (cosmosLove) {
    cosmosLove.style.opacity = "1";
  }
}
</script>
 <script>
    // Create N floating ‚ÄúI love you‚Äù items (was multilingual; now all English)
    const N = 100;     // adjust if you want fewer/more
    const ui = document.getElementById('ui');

    for (let i = 1; i <= N; i++) {
      const love = document.createElement('div');
      love.className = 'love';
      love.style.setProperty('--i', i);

      const h = document.createElement('div');
      h.className = 'love_horizontal';

      const v = document.createElement('div');
      v.className = 'love_vertical';

      const word = document.createElement('div');
      word.className = 'love_word';
      word.textContent = 'I love you';

      v.appendChild(word);
      h.appendChild(v);
      love.appendChild(h);
      ui.appendChild(love);
    }
  </script>
</body>
</html>
